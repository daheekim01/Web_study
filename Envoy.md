**Envoy**는 **고성능의 분산 시스템용 프록시**로, 마이크로서비스 아키텍처에서 트래픽을 관리하고 모니터링하는 데 중요한 역할을 합니다. 특히 **서비스 메시**(Service Mesh) 환경에서 중요한 구성 요소로 사용되며, **애플리케이션 계층(HTTP, gRPC 등)** 및 \*\*네트워크 계층(TCP, UDP 등)\*\*에서 다양한 기능을 제공합니다.

### ✅ **Envoy Proxy란?**

**Envoy**는 **L7(애플리케이션 계층) 프록시**로, **트래픽 라우팅, 로드 밸런싱, 보안, 모니터링, 관찰 가능성** 등을 제공하는 **리버스 프록시**입니다. 원래 **Lyft**라는 회사에서 개발되었으며, 지금은 \*\*Cloud Native Computing Foundation(CNCF)\*\*의 일원으로 관리되고 있습니다.

Envoy는 **서비스 메쉬**에서 중요한 역할을 하며, **Istio**와 같은 서비스 메쉬 시스템에서 \*\*데이터 플레인(Data Plane)\*\*으로 기능합니다. 즉, **서비스 간의 트래픽을 처리하고 관리**하는 프록시 역할을 합니다.

---

### ✅ **Envoy의 주요 기능**

1. **트래픽 라우팅**

   * Envoy는 **서비스 간의 트래픽을 세밀하게 라우팅**할 수 있도록 지원합니다.
   * **라우팅 규칙**을 설정하여 특정 서비스에 들어오는 요청을 다른 서비스로 리다이렉트하거나, A/B 테스트, Canary 배포 등을 할 수 있습니다.

2. **로드 밸런싱**

   * Envoy는 **트래픽을 여러 서버로 분배**하는 로드 밸런싱 기능을 제공합니다.
   * 다양한 로드 밸런싱 알고리즘을 사용하여 트래픽을 효율적으로 분배할 수 있습니다. (예: **라운드 로빈**, **가중치 기반 분배** 등)

3. **보안**

   * Envoy는 **mTLS**(상호 TLS)를 통해 **서비스 간의 통신을 암호화**할 수 있습니다.
   * **인증 및 권한 부여**: Envoy는 서비스 간의 인증과 권한을 관리하며, TLS 인증서를 사용해 **인증된 서비스 간의 안전한 통신**을 보장합니다.

4. **모니터링 및 관찰 가능성**

   * Envoy는 **분산 추적**(Distributed Tracing), **메트릭** 수집, **로깅** 등을 지원하여, 트래픽을 세밀하게 추적하고 모니터링할 수 있습니다.
   * 다양한 **백엔드 툴**과 통합할 수 있어 **Prometheus**, **Grafana**, **Zipkin**, **Jaeger** 등의 시스템과 함께 사용할 수 있습니다.

5. **트래픽 관리**

   * Envoy는 **트래픽 흐름을 제어**할 수 있는 다양한 기능을 제공합니다. 예를 들어, **서킷 브레이커**(Circuit Breaker), **재시도(retry)**, **타임아웃(timeout)**, **슬라이딩 윈도우(sliding window)** 등의 기능을 통해 **서비스의 안정성**을 높일 수 있습니다.

6. **서비스 디스커버리**

   * Envoy는 **동적인 서비스 디스커버리**를 지원합니다. 새로운 서비스가 등장하거나 기존 서비스가 변경되면, 자동으로 **서비스 레지스트리**를 통해 업데이트된 정보를 받아 트래픽을 라우팅합니다.

7. **API 게이트웨이 기능**

   * Envoy는 종종 **API 게이트웨이**로 사용되기도 하며, **인바운드 요청**을 처리하고 외부와의 트래픽을 **정리**하거나 **보안**을 적용할 수 있습니다.

---

### ✅ **Envoy와 서비스 메쉬**

Envoy는 **서비스 메쉬** 환경에서 **데이터 플레인**의 핵심 역할을 합니다. 서비스 메쉬란, **애플리케이션 서비스 간의 트래픽을 관리하고 보안을 강화**하는 네트워크 인프라입니다. Envoy는 **서비스 간의 통신을 안전하고 효율적으로 관리**하고, **서비스 간의 상호작용을 제어**합니다.

### **서비스 메쉬에서 Envoy의 역할**:

1. **트래픽 라우팅**:

   * Envoy는 트래픽을 다양한 서비스에 분배하는 역할을 하며, 서비스 간 트래픽 흐름을 세밀하게 제어합니다.

2. **보안**:

   * 서비스 간 통신을 **mTLS로 암호화**하여 보안을 강화하고, **인증과 권한 부여**를 처리합니다.

3. **모니터링**:

   * 각 서비스에 대한 **분산 추적**, **로그**, **메트릭**을 수집하여 실시간으로 트래픽을 분석하고, 문제가 발생하면 빠르게 대처할 수 있도록 합니다.

---

### ✅ **Envoy의 아키텍처**

Envoy의 아키텍처는 크게 \*\*컨트롤 플레인(Control Plane)\*\*과 \*\*데이터 플레인(Data Plane)\*\*으로 나눠집니다.

1. **컨트롤 플레인(Control Plane)**:

   * **Istio**와 같은 **서비스 메쉬의 컨트롤 플레인**이 Envoy에게 트래픽 처리에 필요한 설정 정보를 제공합니다.
   * Envoy는 컨트롤 플레인에서 수집한 설정을 기반으로 트래픽을 관리합니다.

2. **데이터 플레인(Data Plane)**:

   * 실제 트래픽을 처리하고, 서비스 간의 요청과 응답을 **프록시**합니다.
   * 각 서비스 인스턴스 옆에 배치되는 **sidecar proxy** 형태로 Envoy가 실행됩니다.
   * Envoy는 **로드 밸런싱**, **보안**, **트래픽 관찰** 등의 기능을 수행합니다.

---

### ✅ **Envoy의 주요 기능과 이점**

| 기능                | 설명                              |
| ----------------- | ------------------------------- |
| **트래픽 라우팅**       | 세밀한 트래픽 제어, 서비스 간 라우팅 및 리다이렉션   |
| **로드 밸런싱**        | 여러 서버로 트래픽 분배, 다양한 알고리즘 지원      |
| **보안 기능**         | mTLS를 통한 암호화, 인증과 권한 부여         |
| **모니터링 및 로깅**     | 실시간 메트릭 수집, 분산 추적, 로그 분석        |
| **서킷 브레이커 및 재시도** | 서비스 안정성을 위한 서킷 브레이커, 타임아웃 및 재시도 |
| **API 게이트웨이 역할**  | 외부 요청을 처리하고, 보안 및 인증을 관리        |
| **서비스 디스커버리**     | 동적 서비스 디스커버리 및 자동화된 트래픽 라우팅     |

---

### ✅ **Envoy 사용 사례**

1. **마이크로서비스 아키텍처**:

   * Envoy는 서비스 간의 **트래픽 라우팅**, **보안**, **모니터링**을 관리하면서 마이크로서비스 아키텍처의 복잡성을 해결합니다.

2. **서비스 메쉬 (Service Mesh)**:

   * Istio, Linkerd와 같은 서비스 메쉬에서 데이터 플레인으로 사용되어, **서비스 간의 안전하고 효율적인 통신**을 보장합니다.

3. **API 게이트웨이**:

   * Envoy는 **API 게이트웨이**로 사용될 수 있으며, 외부 요청을 내부 서비스로 라우팅하고, 보안, 인증 등을 관리합니다.

4. **보안 및 암호화**:

   * **mTLS**와 **인증서 기반 인증**을 활용해 서비스 간의 **암호화된 통신**을 보장합니다.

---

