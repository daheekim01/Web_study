물론입니다. **CVE-2018-7600**, 즉 **Drupalgeddon2**는 Drupal에서 발견된 **심각한 원격 코드 실행(RCE) 취약점**으로, 전 세계 수십만 개의 Drupal 사이트에 영향을 주었던 **치명적인 보안 이슈**입니다.
```
element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax
```
## 🔥 요약

| 항목            | 설명                                              |
| ------------- | ----------------------------------------------- |
| **CVE ID**    | CVE-2018-7600                                   |
| **명칭(별명)**    | Drupalgeddon2                                   |
| **영향 버전**     | Drupal 6, 7, 8 (8.3.x, 8.4.x, 8.5.x 등 당시 최신 포함) |
| **취약점 유형**    | RCE (Remote Code Execution)                     |
| **심각도**       | 🔴 Critical (CVSS 9.8/10)                       |
| **공격자 요구 조건** | 인증 없이, 단순 HTTP 요청으로 가능                          |
| **공개일**       | 2018년 3월 28일                                    |
| **PoC 코드 공개** | 2018년 4월 초 (수 일 내에 대규모 악용 시작)                   |

---

## 🧠 어떤 취약점인가요?

Drupal은 내부적으로 **Form API**와 **AJAX API**를 사용하여 사용자 입력을 처리합니다.
이때 Drupal은 AJAX 요청 시 **element\_parents**, **form\_id**, **\_wrapper\_format** 등의 파라미터를 사용해 클라이언트 요청을 처리하는데, Drupalgeddon2는 이 흐름을 **조작해서 PHP 코드를 실행할 수 있도록 우회**한 취약점입니다.

### 👉 요점:

> Drupal이 외부 입력값을 통해 **폼 구조나 렌더링 구조를 조작**할 수 있게 허용하고 있었고, 이를 이용해서 **임의의 함수 호출 및 코드 실행**이 가능했습니다.

---

## 🧪 작동 방식 (간단하게)

1. 공격자는 `element_parents`와 `#post_render`, `#markup` 같은 Form API 속성들을 조작해 Drupal의 렌더링 함수 호출을 유도
2. PHP 함수(예: `exec`, `passthru`, `system`, `assert`, `shell_exec`)를 `#post_render`로 지정
3. 렌더링 시 이 함수가 실행되면서, 공격자가 원하는 명령어가 실행됨
4. 결과: 원격 명령어 실행, 웹쉘 설치, 서버 탈취 등

---

## 📥 예시 요청 (익스플로잇 예시)

```http
POST /user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax HTTP/1.1
Content-Type: application/x-www-form-urlencoded

form_id=user_register_form&mail[a][#post_render][]=exec&mail[a][#markup]=id
```

* 이 요청은 Drupal에게 **`exec('id')`** 를 렌더링 도중 실행하라고 강요합니다.
* 응답에 시스템 사용자 정보가 나오게 됩니다 (예: `uid=33(www-data) gid=33(www-data)`)

---

## 🧨 실제 피해

* **익명 공격자가 단순 POST 요청만으로 서버 장악 가능**
* 웹서버에 **웹쉘 업로드, 백도어 설치, 마이닝 봇 설치** 등 실제 사례 다수 발생
* Drupal 기반 정부, 교육기관, 기업 사이트 수십만 곳이 공격 받음
* 익스플로잇 코드가 공개되자, **수 시간 내에 자동화 봇에 의해 무차별 공격** 시작

---

## 🛡️ 대응 방법

### 🔧 패치 적용

Drupal 보안팀은 다음과 같은 버전을 긴급 배포했습니다:

| Drupal 버전 | 보안 패치 버전              |
| --------- | --------------------- |
| 7.x       | 7.58 (or 7.59, 후속 패치) |
| 8.3.x     | 8.3.9                 |
| 8.4.x     | 8.4.6                 |
| 8.5.x     | 8.5.1                 |

→ 반드시 최신 버전 사용 필수

### 🔐 보안 설정 강화

* 웹 방화벽(WAF)에서 `#post_render`, `element_parents`, `markup` 등의 키워드 필터링
* AJAX 엔드포인트 보호
* Drupal 관리자 경로(IP 제한, 인증 강화 등)

---

## 📚 참고 자료

* [Drupal 공식 보안 권고](https://www.drupal.org/sa-core-2018-002)
* [Exploit DB - PoC 코드](https://www.exploit-db.com/exploits/44449)
* [CVE-2018-7600 상세 설명 - MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7600)

---

## ✅ 결론

> **CVE-2018-7600 (Drupalgeddon2)** 는 Drupal 역사상 가장 치명적인 취약점 중 하나이며, 인증 없이 단 한 번의 HTTP 요청으로 서버를 탈취할 수 있는 RCE 취약점입니다. **패치 적용이 안 된 Drupal 사이트는 지금도 매우 위험**합니다.

---

필요하시면 실제 익스플로잇 분석이나 방어 룰 작성 예시도 도와드릴 수 있습니다.
