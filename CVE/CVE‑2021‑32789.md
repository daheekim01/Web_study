CVE‑2021‑32789는 **WooCommerce Gutenberg Products Block** 기능을 사용하는 사이트에 영향을 주는 **SQL 인젝션 취약점**입니다. 아래에 주요 내용을 정리해 드릴게요:

---

## 취약점 요약

* **영향 대상**
  WooCommerce의 Blocks 기능 플러그인 `woocommerce-gutenberg-products-block`
  **버전 2.5.0 이상, 2.5.16 미만**, 그리고 WooCommerce 코어 자체 일부 버전에도 영향을 받습니다.
  ([INCIBE][1], [wiz.io][2])

* **취약점 설명**
  공격자는 `wc/store/products/collection-data?calculate_attribute_counts[][taxonomy]` API 엔드포인트를 이용해,
  잘 조작된 URL을 통해 **인증 없이 읽기 전용(SQL read-only) 쿼리를 실행**할 수 있습니다.
  ([NVD][3], [Rapid7][4], [wiz.io][2])

---

## 위험도 및 영향

* **공격 난이도**: 낮음 (네트워크로 원격에서 쉽게 공격 가능)
* **취약성 심각도**: 높음 (SQL Injection)
* **CVSS v3.1 점수**: 7.5 – High
  ([INCIBE][1], [Tenable®][5], [Feedly][6])

이로 인해 **고객 정보, 주문 정보, API 키 등 민감 데이터가 노출될 수 있습니다**.
읽기 전용이지만, 정보 누출로 충분히 중요한 위협이 될 수 있습니다.

---

## 패치 및 대응 권장 사항

* **즉시 업데이트하세요.**

  * WooCommerce Blocks 플러그인을 **버전 2.5.16 이상**으로 업데이트 (또는 WooCommerce 자체를 최신 버전으로)
    ([Rapid7][4], [wiz.io][2], [CloudDefense.AI][7])

* **기타 대응 방법**:

  * Prepared Statements 사용
  * 입력값 검증 및 화이트리스트 기반 필터링 적용
    ([Aqua Vulnerability Database][8])
  * WAF나 보안 솔루션을 통해 `calculate_attribute_counts[][taxonomy]`와 같은 의심 요청 차단

---

## 요약 테이블

| 항목        | 설명                                                                        |
| --------- | ------------------------------------------------------------------------- |
| **취약함**   | WooCommerce Blocks 플러그인 (v2.5.0 \~ v2.5.16 미만)                            |
| **공격 방식** | SQL Injection via API endpoint (`calculate_attribute_counts[][taxonomy]`) |
| **영향**    | 읽기 전용 SQL 쿼리 실행 → 데이터 유출 위험                                               |
| **심각도**   | CVSS 7.5 (High)                                                           |
| **대응**    | 패치/업데이트, 입력 검증, WAF 설정, 보안 모니터링                                           |

---

필요하시면 이 취약점이 실제로 어떻게 작동하는지, PoC나 방어용 WAF 룰 예시도 제공해드릴 수 있어요. 도움이 필요하시면 언제든지 말씀해주세요!

[1]: https://www.incibe.es/index.php/en/incibe-cert/early-warning/vulnerabilities/cve-2021-32789?utm_source=chatgpt.com "CVE-2021-32789 | INCIBE | INCIBE"
[2]: https://www.wiz.io/vulnerability-database/cve/cve-2021-32789?utm_source=chatgpt.com "CVE-2021-32789 Impact, Exploitability, and Mitigation Steps | Wiz"
[3]: https://nvd.nist.gov/vuln/detail/CVE-2021-32789?utm_source=chatgpt.com "NVD - CVE-2021-32789"
[4]: https://www.rapid7.com/db/vulnerabilities/woo-gutenberg-products-block-plugin-cve-2021-32789/?utm_source=chatgpt.com "Rapid7 Vulnerability Database"
[5]: https://www.tenable.com/cve/CVE-2021-32789?utm_source=chatgpt.com "CVE-2021-32789<!-- --> | Tenable®"
[6]: https://feedly.com/cve/CVE-2021-32789?utm_source=chatgpt.com "CVE-2021-32789 - Exploits & Severity - Feedly"
[7]: https://www.clouddefense.ai/cve/2021/CVE-2021-32789?utm_source=chatgpt.com "CVE-2021-32789: Arbitrary SQL Injection via WooCommerce Gutenberg Products Block"
[8]: https://avd.aquasec.com/nvd/2021/cve-2021-32789/?utm_source=chatgpt.com "CVE-2021-32789 | Vulnerability Database | Aqua Security"
