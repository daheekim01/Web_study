## 📌 CVE-2025-64446 

* **취약점 종류**: **상대 경로 순회 (relative path traversal)**
* **영향 대상**: Fortinet의 **FortiWeb WAF**
* **심각도**: 매우 높음 (CVSS 9.8 / Critical)

---

## 어떻게 공격이 가능한가? 🔍

경로 탐색 취약점이 존재하여 단순한 경로 조작 문자열만으로 /cgi-bin/fwbcgi 경로에 접근 가능

```
/api/v2.0/cmdb/system/admin?/../../../../../cgi-bin/fwbcgi
```

1. 공격자가 조작된 HTTP/ HTTPS 요청을 FortiWeb 관리 API 경로 쪽으로 보냄
2. 요청 경로에 `../../` 같은 트래버설 패턴을 넣어 내부 CGI 핸들러 (`fwbcgi`)에 접근
   * `/api/v2.0/cmdb/system/admin` 경로 등에 디렉토리 트래버설(예: `../../../../../cgi-bin/fwbcgi`) 패턴을 삽입해 내부 CGI 핸들러(`fwbcgi`)에 접근하게 됨.
3. 내부 CGI 핸들러는 `HTTP_CGIINFO` 헤더를 신뢰하는 로직이 있고, `HTTP_CGIINFO` 헤더에 공격자가 Base64 인코딩된 JSON을 삽입 → 예: `{"username":"super_admin", ...}`
4. FortiWeb이 이 값을 신뢰해서 **관리자 권한 세션을 위조**
5. 결과적으로 공격자는 관리자 권한으로 설정 변경, 새로운 관리자 계정 만들기 등 가능

---

## 공격 임팩트 🚨

* 인증 없이 **관리자 권한** 획득 가능
* 지속성 확보: 새로운 관리자 계정 생성 가능
* FortiWeb이 네트워크 보안장치라면, 이 장치를 장악하면 내부 트래픽, 보안 정책을 마음대로 조작할 수 있음
* 사실상 **원격 코드 실행 수준 권한 획득** 가능성 있음

---

# 🦠 최근 공격 트렌드 & 전술(TTP)

## 1️⃣ **인터넷에 노출된 FortiWeb 관리 포트 스캔 증가**

공격자는 Shodan, ZoomEye 같은 검색 엔진을 사용하거나 직접 스캐닝해서

* **:80 / :443**
* **FortiWeb 관리자 포털 노출 포트**
  등을 자동으로 탐색하는 패턴이 증가함.

🔍 **특징:**

* 봇넷이 반복적으로 특정 URL 패턴을 조회함
* 실제 공격 전 스캐닝 단계에서 독특한 user-agent가 등장
  (대부분 자동화 도구/스크립트 기반)

---

## 2️⃣ **경로 트래버설 → 관리자 인증 우회 조합 공격**

이 취약점의 핵심은 다음 두 가지 기술이 합쳐졌다는 점임:

* **경로 트래버설(Path Traversal)**
* **내부 CGI 핸들러로 인증정보 주입(Authentication Spoofing)**

공격자들은 단순히 파일을 읽는 게 아니라,
WAF가 내부적으로 사용하는 인증 모듈까지 접근해 **관리자 세션을 위조**하려고 함.

🧩 **전술적 특징**

* 공격자는 “정상 관리자 계정이 존재하는 듯한” 세션을 만든 뒤 WAF 설정 페이지에 접근
* 실제 관리자 로그랑 구별 어려운 시점이 생김 → 탐지 난이도 ↑

---

## 3️⃣ **공격 이후의 2차 악성 행위 증가**

FortiWeb을 장악하면 WAF 정책 조작이 가능해짐.

공격자들은:

* 🔧 **백도어 관리자 계정 생성**
* 🔄 **정책을 무력화**(특정 IP나 URL 필터 제외)
* 📤 **내부망으로의 pivoting(측면 이동)**
* 🔍 **내부/외부 트래픽 가로채기, 로깅 우회**

이런 후속 행위가 많이 포착됨.

